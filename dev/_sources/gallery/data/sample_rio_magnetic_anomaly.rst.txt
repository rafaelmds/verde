

.. _sphx_glr_gallery_data_sample_rio_magnetic_anomaly.py:


Magnetic data from Rio de Janeiro
=================================

We provide sample total-field magnetic anomaly data from an airborne survey of
Rio de Janeiro, Brazil, from the 1970s. The data are made available by the
Geological Survey of Brazil (CPRM) through their `GEOSGB portal
<http://geosgb.cprm.gov.br/>`__. See the documentation for
:func:`verde.datasets.fetch_rio_magnetic_anomaly` for more details.




.. image:: /gallery/data/images/sphx_glr_sample_rio_magnetic_anomaly_001.png
    :align: center


.. rst-class:: sphx-glr-script-out

 Out::

    longitude   latitude  total_field_anomaly_nt  height_ell_m
    0 -42.590424 -22.499878                  115.41        264.26
    1 -42.590485 -22.498978                  121.35        265.48
    2 -42.590530 -22.498077                  128.29        263.96
    3 -42.590591 -22.497177                  133.24        258.47
    4 -42.590652 -22.496277                  136.18        252.07




|


.. code-block:: python

    import matplotlib.pyplot as plt
    import cartopy.crs as ccrs
    import numpy as np
    import verde as vd

    # The data are in a pandas.DataFrame
    data = vd.datasets.fetch_rio_magnetic_anomaly()
    print(data.head())

    # Make a Mercator plot of the data using Cartopy
    plt.figure(figsize=(7, 5))
    ax = plt.axes(projection=ccrs.Mercator())
    ax.set_title('Total-field Magnetic Anomaly of Rio de Janeiro', pad=25)
    # Since the data is diverging (going from negative to positive)
    # we need to center our colorbar on 0. To do this, we calculate
    # the maximum absolute value of the data to set vmin and vmax.
    maxabs = np.max(np.abs([data.total_field_anomaly_nt.min(),
                            data.total_field_anomaly_nt.max()]))
    # Cartopy requires setting the projection of the original data through the
    # transform argument. Use PlateCarree for geographic data.
    plt.scatter(data.longitude, data.latitude, c=data.total_field_anomaly_nt,
                s=1, cmap='seismic', vmin=-maxabs, vmax=maxabs,
                transform=ccrs.PlateCarree())
    cb = plt.colorbar(pad=0.1)
    cb.set_label('nT')
    ax.gridlines(draw_labels=True)
    # Set the extent of the plot to the limits of the data
    ax.set_extent(vd.get_region(data.longitude, data.latitude))
    plt.tight_layout()
    plt.show()

**Total running time of the script:** ( 0 minutes  0.252 seconds)



.. container:: sphx-glr-footer


  .. container:: sphx-glr-download

     :download:`Download Python source code: sample_rio_magnetic_anomaly.py <sample_rio_magnetic_anomaly.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: sample_rio_magnetic_anomaly.ipynb <sample_rio_magnetic_anomaly.ipynb>`

.. rst-class:: sphx-glr-signature

    `Generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
